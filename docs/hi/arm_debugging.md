# Eclipse का उपयोग करते हुए ARM डिबगिंग
यह पृष्ठ बताता है कि एक SWD एडाप्टर और ओपन-सोर्स / नि:शुल्क टूल्स का उपयोग करके ARM MCUs के लिए डिबगिंग सेटअप कैसे करें। इस गाइड में हम सभी आवश्यक निर्भरता के साथ GNU MCU Eclipse आईडीई C/C++ डेवलपर्स के लिए और OpenOCD स्थापित करेंगे।

इस गाइड को अग्रिम उपयोगकर्ताओं की ओर ले जाया जाता है और यह माना जाता है कि आप MAKE प्रवाह का उपयोग करके अपनी मशीन पर ARM संगत कीबोर्ड संकलित कर सकते हैं।

## सॉफ्टवेयर इंस्टॉल करना

यहां मुख्य उद्देश्य MCU Eclipse IDE को हमारी मशीन पर सही तरीके से स्थापित करना है। आवश्यक निर्देश [यह] (https://gnu-mcu-eclipse.github.io/install/) से स्थापित गाइड से प्राप्त होते हैं।

### xPack प्रबंधक

यह उपकरण एक सॉफ्टवेयर पैकेज मैनेजर है और इसका उपयोग हमें आवश्यक निर्भरता प्राप्त करने में मदद करने के लिए किया जाता है।

XPM Node.js का उपयोग करके चलाता है [यहां](https://nodejs.org/en/)। स्थापना के बाद, एक टर्मिनल खोलें और `npm -v` टाइप करें। संस्करण संख्या के साथ एक उत्तर का अर्थ है कि स्थापना सफल रही।

XPM इंस्टॉलेशन निर्देश [यहां] (https://www.npmjs.com/package/xpm) पाया जा सकता है और OS विशिष्ट हैं। अपने टर्मिनल में `xpm --version` टाइप करके सॉफ्टवेयर संस्करण वापस करना चाहिए।

### ARM टूलचैन

XPM का उपयोग करके ARM टूलचैन को स्थापित करना बहुत आसान है। कमांड दर्ज करें `xpm install --global @ gnu-mcu-eclipse / arm-none-eabi-gcc`।

### Windows निर्माण उपकरण

यदि आप Windows का उपयोग कर रहे हैं तो आपको इसे स्थापित करने की आवश्यकता है!

`xpm install --global @ gnu-mcu-eclipse / windows-build-tools`

### प्रोग्रामर / डिबगर ड्राइवर्स

अब आपके प्रोग्रामर के ड्राइवरों को स्थापित करने का समय आ गया है। यह ट्यूटोरियल ST-Link v2 का उपयोग करके बनाया गया था, जिसे आप लगभग कहीं से भी प्राप्त कर सकते हैं।
यदि आपके पास एसटी-लिंक है, तो ड्राइवर [यहां] (https://www.st.com/en/development-tools/stsw-link009.html) मिल सकते हैं अन्यथा अपने उपकरण के निर्माता से परामर्श करें।

### OpenOCD

यह निर्भरता GBD से SWD की अनुमति देता है और यह डीबगिंग के लिए आवश्यक है। रन `xpm install --global @ gnu-mcu-eclipse / openocd`।

### Java

Java को Eclipse की जरूरत है इसलिए कृपया इसे [यहां] (https://www.oracle.com/technetwork/java/javase/downloads/index.html) से डाउनलोड करें।

### GNU MCU Eclipse IDE

अब IDE को स्थापित करने का अंतिम समय है। नवीनतम संस्करण प्राप्त करने के लिए रिलीज़ पृष्ठ [यहाँ] (https://github.com/gnu-mcu-eclipse/org.eclipse.epp.packages/releases/) का उपयोग करें।

## Eclipse को कॉन्फ़िगर करना

हमारे द्वारा डाउनलोड किए गए Eclipse IDE को खोलें। हमारी QMK निर्देशिका को आयात करने के लिए File -> Import -> C / C ++ -> Existing Code as Makefile Project को  चुनें। Next चुनें और अपने QMK फ़ोल्डर का चयन करने के लिए Browse का उपयोग करें। टूल-चेन सूची में ARM Cross GCC चुनें और फिनिश चुनें।

अब आप बाईं ओर QMK फ़ोल्डर देख सकते हैं। इसे राइट क्लिक करें और Properties चुनें। बाईं ओर, MCU का विस्तार करें और ARM Toolchain Paths का चयन करें। प्रेस xPack और ठीक है। OpenOCD Path के लिए दोहराएं और यदि आप Windows पर हैं Build Tool Path के लिए। Apply करें और बंद करें का चयन करें।

अब आवश्यक MCU पैकेजों को स्थापित करने का समय है। Packs Perspective में जाएं Window -> Open Perpective -> Others -> Packs का चयन करके । अब Packs टैब के आगे पीले Refresh सिंबल का चयन करें। यह एक लंबा समय लगेगा क्योंकि यह विभिन्न स्थानों से MCU परिभाषाओं का अनुरोध कर रहा है। यदि कुछ लिंक विफल हो जाते हैं तो आप शायद इग्नोर कर सकते हैं।

जब यह पूरा हो जाता है, तो आपको MCU खोजना होगा, जिसके लिए हम निर्माण / डिबगिंग करेंगे। इस उदाहरण में मैं STM32F3 Series MCUs का उपयोग करूंगा। बाईं ओर, STMicroelectonics -> STM32F3 Series चुनें। मध्य खिड़की पर हम पैक देख सकते हैं। राइट क्लिक करें और Install चुनें। एक बार जो हो गया तो हम Default Perspective, Window -> Open Perspective -> Others -> ​​C / C ++ पर वापस जा सकते हैं।

हमें  Eclipse को जानने देना चाहिए जिस डिवाइस पर हम QMK बनाने का इरादा रखते हैं। QMK फ़ोल्डर पर राइट क्लिक करें -> Properties -> C / C ++ Build -> Settings। Devices टैब का चयन करें और उपकरणों के तहत अपने MCU के उपयुक्त संस्करण का चयन करें। मेरे उदाहरण के लिए यह STM32F303CC है

जब हम यहां हैं तो चलो बिल्ड कमांड को भी सेटअप करते हैं। C / C ++ बिल्ड और फिर Behaviour टैब चुनें। बिल्ड कमांड पर, 'all' को अपने आवश्यक कमांड के साथ बदलें। उदाहरण के लिए Default keymap के साथ एक Rev6 Planck के लिए यह `planck / rev6: default` होगा। Apply करें और Close चयन करें।

## Building

यदि आपके पास सेटअप सब कुछ सही ढंग से है, Hammer बटन दबाने पर आपके लिए Firmware का Build करना चाहिए और एक .bin फ़ाइल दिखाई देनी चाहिए।

## डिबगिंग

### डीबगर कनेक्ट करना

ARM MCUs Single Wire Debug (SWD) प्रोटोकॉल का उपयोग करते हैं जिसमें Clock (SWCLK) सिग्नल और Data (SWDIO) सिग्नल शामिल होते हैं। इस दो तारों और Ground को जोड़ने के लिए एमसीयू के पूर्ण हेरफेर की अनुमति देने के लिए पर्याप्त होना चाहिए। यहां हम मान लेते हैं कि कीबोर्ड USB द्वारा संचालित किया जाएगा। Reset संकेत आवश्यक नहीं है क्योंकि हम Reset बटन का उपयोग करके इसे मैन्युअल रूप से मुखर कर सकते हैं। अधिक अग्रिम सेटअप के लिए, SWO सिग्नल का उपयोग किया जा सकता है जो होस्ट के लिए अतुल्यकालिक रूप से printf और scanf को पाइप करता है लेकिन हमारे सेटअप के लिए हम इसे अनदेखा कर देंगे।

नोट: सुनिश्चित करें कि आपके कीबोर्ड के मैट्रिक्स में SWCLK और SWDIO पिन का उपयोग नहीं किया गया है। यदि वे हैं तो आप अस्थायी रूप से उन्हें कुछ अन्य पिन के लिए स्विच कर सकते हैं।

### डीबगर को कॉन्फ़िगर करना

अपने QMK फ़ोल्डर पर राइट क्लिक करें, Debug As -> Debug Configuration चुनें। यहां GDB OpenOCD Debugging पर डबल क्लिक करें। Debugger टैब चुनें और अपने MCU के लिए आवश्यक कॉन्फ़िगरेशन दर्ज करें। यह पता लगाने के लिए कुछ googleing लग सकता है। STM32F3 के लिए डिफ़ॉल्ट स्क्रिप्ट को stm32f3discovery.cfg कहा जाता है। OpenOCD को बताने के लिए, विन्यास विकल्पों में `-f Board / stm32f3discovery.cfg` दर्ज करें।

नोट: मेरे मामले में इस कॉन्फ़िगरेशन स्क्रिप्ट को रीसेट मुखर को अक्षम करने के लिए संपादन की आवश्यकता है। पटकथा के स्थानों को वास्तविक निष्पादन योग्य क्षेत्र में आमतौर पर `ओपनोकेड / संस्करण / .content / स्क्रिप्ट / बोर्ड` के तहत पाया जा सकता है। यहाँ मैंने `reset_config srst_only` को` reset_config none` को संपादित किया।

लागू करें और बंद करें का चयन करें।

### डिबगर चलाना।

अपना कीबोर्ड रीसेट करें।

Bug आइकन दबाएं और अगर सब ठीक हो जाता है तो आपको जल्द ही अपने आप को Debug Perspective में पाएंगे । यहां प्रोग्राम काउंटर मुख्य समारोह की शुरुआत में रुक जाएगा और आपके लिए प्ले प्रेस करने का तरीका होगा। सभी डिबगर्स की अधिकांश सुविधाएँ ARM MCUs पर काम करती हैं लेकिन सटीक विवरण के लिए google आपका मित्र है!


Happy Debugging!









