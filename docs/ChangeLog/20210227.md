# QMK Breaking Changes - 2021 February 27 Changelog

## Changes Requiring User Action

* 012: [Keyboard] Add Pix ([#11154](https://github.com/qmk/qmk_firmware/pull/11154))
* 014: [Keyboard] Refactor Jacky's boards (Bear65 and S7 Elephant) ([#10528](https://github.com/qmk/qmk_firmware/pull/10528))
* 022: Remove handwired/bluepill. ([#11415](https://github.com/qmk/qmk_firmware/pull/11415))
* 056: [Keyboard] Added rev2 & move rev1+rev2 to parent folder ([#10973](https://github.com/qmk/qmk_firmware/pull/10973))
* 137: added `unix60`, moved togehter with `southpaw75` into `fr4` folder ([#11195](https://github.com/qmk/qmk_firmware/pull/11195))


## Core Changes

### Fixes

* 007: GCC 10 can now compiled Drop Alt firmware ([#9485](https://github.com/qmk/qmk_firmware/pull/9485))
* 019: Fix compiling on `develop` branch ([#11409](https://github.com/qmk/qmk_firmware/pull/11409))
* 020: Fix broken keyboards ([#11412](https://github.com/qmk/qmk_firmware/pull/11412))
* 024: Fix broken keyboards on develop ([#11427](https://github.com/qmk/qmk_firmware/pull/11427))
* 027: Fix up build dependencies. ([#11435](https://github.com/qmk/qmk_firmware/pull/11435))
  * Fixes up build dependencies so that the generated files are correctly made available previous to compiling any object files.
* 029: Fix compiling `squiggle/rev1` ([#11448](https://github.com/qmk/qmk_firmware/pull/11448))
* 030: Fix compiling `treadstone32/rev1` ([#11447](https://github.com/qmk/qmk_firmware/pull/11447))
* 045: Another round of develop fixing ([#11473](https://github.com/qmk/qmk_firmware/pull/11473))
* 058: Fixup line endings. (#direct)
* 068: `qmk cformat` ([#11594](https://github.com/qmk/qmk_firmware/pull/11594))
* 070: Fixup builds on develop branch. ([#11600](https://github.com/qmk/qmk_firmware/pull/11600))
* 089: Include `stdbool.h` in `uart.h` ([#11728](https://github.com/qmk/qmk_firmware/pull/11728))
* 090: Fix user keymaps that aren't compiling ([#11584](https://github.com/qmk/qmk_firmware/pull/11584))
* 111: Fixup `lck75` line endings. (#direct)
* 107: Decouple USB events from the USB interrupt handler in ChibiOS ([#10437](https://github.com/qmk/qmk_firmware/pull/10437))
* 110: Address wake from sleep instability ([#11450](https://github.com/qmk/qmk_firmware/pull/11450))
* 117: [Bug] Fix media key missing upstroke event ([#11162](https://github.com/qmk/qmk_firmware/pull/11162))

### Additions and Enhancements

* 001: Allow configuration of serial USART timeout ([#11057](https://github.com/qmk/qmk_firmware/pull/11057))
* 003: Added Sync Timer feature for Split Common keyboards ([#10997](https://github.com/qmk/qmk_firmware/pull/10997))
* 009: Add modifier state to the Split Common transport ([#10400](https://github.com/qmk/qmk_firmware/pull/10400))
* 013: Implement option for kinetic mouse movement algorithm for mouse keys ([#6739](https://github.com/qmk/qmk_firmware/pull/6739))
* 018: :flag: Improved Language Specific Keycodes for US International and Extended Layouts ([#11307](https://github.com/qmk/qmk_firmware/pull/11307))
* 023: Split up `QWIIC_ENABLE` to use `QWIIC_DRIVERS` as well, with yes/no for enable flag. ([#11426](https://github.com/qmk/qmk_firmware/pull/11426))
* 028: Allow AVR-based keyboards to override the `bootloader_jump` function ([#11418](https://github.com/qmk/qmk_firmware/pull/11418))
* 057: Refine RGBLight Twinkle effect to be smoother (use breathing curve) ([#11350](https://github.com/qmk/qmk_firmware/pull/11350))
* 060: Keep track of last matrix activity ([#10730](https://github.com/qmk/qmk_firmware/pull/10730))
    * 065: Revert "Keep track of last matrix activity ([#10730](https://github.com/qmk/qmk_firmware/pull/10730))"
    * 067: Keep track of last matrix activity. ([#11552](https://github.com/qmk/qmk_firmware/pull/11552))
* 062: fix `matrix_io_delay()` timing in `quantum/matrix.c` ([#9603](https://github.com/qmk/qmk_firmware/pull/9603))
* 078: Keep track of encoder activity ([#11595](https://github.com/qmk/qmk_firmware/pull/11595))
* 084: Backport ChibiOS Audio changes from ZSA ([#11687](https://github.com/qmk/qmk_firmware/pull/11687))
* 085: Add support for 8 buttons to mouse report ([#10807](https://github.com/qmk/qmk_firmware/pull/10807))
* 086: Allow `post_config.h` to be implemented in userspace ([#11519](https://github.com/qmk/qmk_firmware/pull/11519))
* 087: Adds AT90USB162 support ([#11570](https://github.com/qmk/qmk_firmware/pull/11570))
* 108: Stop sounds when suspended ([#11553](https://github.com/qmk/qmk_firmware/pull/11553))
* 115: [Keymap] Revamp spidey3 userspace and keymaps ([#11768](https://github.com/qmk/qmk_firmware/pull/11768))
* 125: Add support for analog USBPD on STM32G4xx. ([#11824](https://github.com/qmk/qmk_firmware/pull/11824))
* 129: Matrix matrix can now be transported to the slave side in Split Common keyboards ([#11046](https://github.com/qmk/qmk_firmware/pull/11046))
* 131: RGBLight: Allow configurable default settings ([#11912](https://github.com/qmk/qmk_firmware/pull/11912))
* 132: Add `tap_code_delay(code, delay)` ([#11913](https://github.com/qmk/qmk_firmware/pull/11913))
* 133: Fix compilation error for `tap_code_delay()` ([#11938](https://github.com/qmk/qmk_firmware/pull/11938))

### Clean-ups and Optimizations

* 010: Fix duplicate `I2C_KEYMAP_START` define ([#11237](https://github.com/qmk/qmk_firmware/pull/11237))
* 015: Rewrite APA102 support for RGBLight ([#10894](https://github.com/qmk/qmk_firmware/pull/10894))
* 016: Update ADB Protocol implementation in TMK Core ([#11168](https://github.com/qmk/qmk_firmware/pull/11168))
* 059: Remove unused `action_get_macro()` usages in user files ([#11165](https://github.com/qmk/qmk_firmware/pull/11165))
* 079: Remove `QMK_KEYBOARD_CONFIG_H` ([#11576](https://github.com/qmk/qmk_firmware/pull/11576))
* 080: Remove duplicated housekeeping in `arm_atsam` ([#11672](https://github.com/qmk/qmk_firmware/pull/11672))
* 083: UART driver refactor ([#11637](https://github.com/qmk/qmk_firmware/pull/11637))
* 109: Move `transport.c` to `QUANTUM_LIB_SRC` ([#11751](https://github.com/qmk/qmk_firmware/pull/11751))
* 112: Remove `MIDI_ENABLE_STRICT` from user keymaps ([#11750](https://github.com/qmk/qmk_firmware/pull/11750))
* 114: Remove legacy print backward compatiblitly ([#11805](https://github.com/qmk/qmk_firmware/pull/11805))
* 116: Migrate mousekey to quantum ([#11804](https://github.com/qmk/qmk_firmware/pull/11804))
* 118: remove deprecated `qmk json-keymap` ([#11823](https://github.com/qmk/qmk_firmware/pull/11823))
* 119: Remove FAUXCLICKY feature (deprecated) ([#11829](https://github.com/qmk/qmk_firmware/pull/11829))
* 121: Refactor platform logic within `print.h` ([#11863](https://github.com/qmk/qmk_firmware/pull/11863))
* 126: Audio system overhaul ([#11820](https://github.com/qmk/qmk_firmware/pull/11820))
* 135: Output selection: Remove "USB and BT" option for Bluetooth ([#11940](https://github.com/qmk/qmk_firmware/pull/11940))
* 136: `tmk_core/common/action.c`: refactor for code size; merge multiple `case`s into one ([#11943](https://github.com/qmk/qmk_firmware/pull/11943))

### QMK API

* 017: Configure keyboard matrix from info.json ([#10817](https://github.com/qmk/qmk_firmware/pull/10817))
* 031: Validate our JSON data using json_schema ([#11101](https://github.com/qmk/qmk_firmware/pull/11101))
* 050: Use the schema to eliminate custom code ([#11108](https://github.com/qmk/qmk_firmware/pull/11108))
* 053: Add support for specifying BOARD in `info.json` ([#11492](https://github.com/qmk/qmk_firmware/pull/11492))
* 055: Document how to add data driven configurations ([#11502](https://github.com/qmk/qmk_firmware/pull/11502))
* 063: Process info.json rules ahead of userspace rules ([#11542](https://github.com/qmk/qmk_firmware/pull/11542))
* 064: Remove duplicate manufacturer definitions ([#11544](https://github.com/qmk/qmk_firmware/pull/11544))
* 081: Update list of MCUs in `keyboard.jsonschema` to mirror `qmk.constants.py` ([#11688](https://github.com/qmk/qmk_firmware/pull/11688))
* 106: Create a system to map between `info.json` and `config.h`/`rules.mk` ([#11548](https://github.com/qmk/qmk_firmware/pull/11548))


## QMK Infrastructure and Internals

* 005: Disable almost all ChibiOS subsystems in default configs ([#11111](https://github.com/qmk/qmk_firmware/pull/11111))
* 113: Add STM32G431 and STM32G474 board definitions. ([#11793](https://github.com/qmk/qmk_firmware/pull/11793))
* 120: bump to python 3.7 ([#11408](https://github.com/qmk/qmk_firmware/pull/11408))
* 123: [CI] Format develop ([#11893](https://github.com/qmk/qmk_firmware/pull/11893))
* 124: Format code according to conventions ([#11905](https://github.com/qmk/qmk_firmware/pull/11905))
* 127: Format code according to conventions ([#11907](https://github.com/qmk/qmk_firmware/pull/11907))
* 130: Format code according to conventions ([#11928](https://github.com/qmk/qmk_firmware/pull/11928))
* 134: Format code according to conventions ([#11936](https://github.com/qmk/qmk_firmware/pull/11936))

### ChibiOS Update and Config Migration

QMK's ChibiOS and ChibiOS-Contrib submodules have been updated to version 20.3.2.

Along with this, QMK now provides configuration files for all ChibiOS-supported microcontrollers, such that keyboards now are only required to define settings which differ from the defaults specified by the QMK-provided files, reducing the size of pull requests for keyboards running ChibiOS-supported MCUs.

* 004: Add board specific to Proton-C, with usual defaults turned on. ([#10976](https://github.com/qmk/qmk_firmware/pull/10976))
* ([#10418](https://github.com/qmk/qmk_firmware/pull/10418), [#11123](https://github.com/qmk/qmk_firmware/pull/11123), [#11261](https://github.com/qmk/qmk_firmware/pull/11261), [#11413](https://github.com/qmk/qmk_firmware/pull/11413), [#11414](https://github.com/qmk/qmk_firmware/pull/11414), [#11495](https://github.com/qmk/qmk_firmware/pull/11495), [#11504](https://github.com/qmk/qmk_firmware/pull/11504), [#11529](https://github.com/qmk/qmk_firmware/pull/11529), [#11588](https://github.com/qmk/qmk_firmware/pull/11588), [#11598](https://github.com/qmk/qmk_firmware/pull/11598), [#11607](https://github.com/qmk/qmk_firmware/pull/11607), [#11617](https://github.com/qmk/qmk_firmware/pull/11617), [#11620](https://github.com/qmk/qmk_firmware/pull/11620), [#11630](https://github.com/qmk/qmk_firmware/pull/11630), [#11646](https://github.com/qmk/qmk_firmware/pull/11646), [#11689](https://github.com/qmk/qmk_firmware/pull/11689), [#11846](https://github.com/qmk/qmk_firmware/pull/11846), [#11927](https://github.com/qmk/qmk_firmware/pull/11927))
* 052: Disable subsystems repo-wide. ([#11449](https://github.com/qmk/qmk_firmware/pull/11449))
* 071: Leftover early initialisation conversions ([#11615](https://github.com/qmk/qmk_firmware/pull/11615))
* 075: Fix up comments showing how to execute config migration. ([#11621](https://github.com/qmk/qmk_firmware/pull/11621))


