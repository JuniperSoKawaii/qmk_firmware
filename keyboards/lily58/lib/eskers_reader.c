#include "quantum.h"
#include <stdio.h>
#include <stdbool.h>

#define L_WINDOWS 0
#define L_LINUX 1
#define L_GAMING 2
#define L_LOWER 3
#define L_RAISE 4
#define L_ADJUST 5
#define L_GLOWER 6

char default_layer_str[64];
char highest_layer_str[6];
char caps_state_str[6];

//Mode Logos
//Windows
static const char PROGMEM win_str[64] = {
    //Windows 10 Logo
    //0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    //0x00, 0x00, 0x00, 0x00, 0x00, 0xbc,
    //0xbc, 0xbe, 0xbe, 0x00, 0xbe, 0xbe,
    //0xbf, 0xbf, 0xbf, 0xbf, 0x00, 0x00,
    //0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    //0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    //0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    //0x00, 0x07, 0x07, 0x0f, 0x0f, 0x00,
    //0x0f, 0x0f, 0x1f, 0x1f, 0x1f, 0x1f,
    //0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    //0x00, 0x00, 0x00, 0x00
    //Windows 11 Logo
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x7F, 0x7F, 0x7F,
    0x7F, 0x7F, 0x7F, 0x7F, 0x00, 0x7F,
    0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x7F,
    0x7F, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F,
    0x00, 0x7F, 0x7F, 0x7F, 0x7F, 0x7F,
    0x7F, 0x7F, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
};
//Tux
static const char PROGMEM tux_str[64] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
    0xE0, 0x7E, 0x5B, 0x4F, 0x5B, 0xFE,
    0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x30,
    0x7B, 0x7F, 0x78, 0x30, 0x20, 0x20,
    0x30, 0x78, 0x7F, 0x3B, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00,
};
//Gamepad
static const char PROGMEM pad_str[64] = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0xF8,
    0xFC, 0xFC, 0xDE, 0xDF, 0x07, 0xDF,
    0xDF, 0xFE, 0xFE, 0xFE, 0xFE, 0xFE,
    0xFE, 0xFE, 0x3F, 0x3F, 0xFF, 0xE7,
    0xE6, 0xFC, 0xFC, 0xF8, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x3F, 0x7F, 0x7F, 0x3F, 0x1F,
    0x0F, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
    0x0F, 0x1F, 0x3F, 0x7F, 0x7F, 0x3F,
    0x00, 0x00, 0x00, 0x00,
    };

const char *mode_state(void) {
    switch(get_highest_layer(default_layer_state)) {
        case L_WINDOWS:
            return win_str;
        case L_LINUX:
            return tux_str;
        case L_GAMING:
            return pad_str;
        default:
            snprintf(highest_layer_str, sizeof(highest_layer_str), "Undef");
    }
    return highest_layer_str;
}

const char *highest_layer(void) {
    switch (get_highest_layer(layer_state)) {
        case L_WINDOWS:
        case L_LINUX:
        case L_GAMING:
            snprintf(highest_layer_str, sizeof(highest_layer_str), "BASE ");
            break;
        case L_RAISE:
            snprintf(highest_layer_str, sizeof(highest_layer_str), "RAISE");
            break;
        case L_LOWER:
        case L_GLOWER:
            snprintf(highest_layer_str, sizeof(highest_layer_str), "LOWER");
            break;
        case L_ADJUST:
            snprintf(highest_layer_str, sizeof(highest_layer_str), "ADJ  ");
            break;
        default:
            snprintf(highest_layer_str, sizeof(highest_layer_str), "Undef");
    }

    return highest_layer_str;
}

const char *caps_state(void) {
    led_t led_state = host_keyboard_led_state();

    switch(led_state.caps_lock) {
        case 1:
            if(!is_caps_word_on()) {
                snprintf(caps_state_str, sizeof(caps_state_str), "CPSLK");
            } else {
                snprintf(caps_state_str, sizeof(caps_state_str), "cpswd");
            }
            break;
        default:
            if(!is_caps_word_on()) {
                snprintf(caps_state_str, sizeof(caps_state_str), "     ");
            } else {
                snprintf(caps_state_str, sizeof(caps_state_str), "CPSWD");
            }
    }

    return caps_state_str;
}
